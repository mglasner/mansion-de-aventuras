/* Estilos — Biblioteca de Aventuras */

/* --- Estilos por habitación --- */
@import url('css/habitacion1.css');
@import url('css/habitacion2.css');
@import url('css/habitacion3.css');
@import url('css/habitacion4.css');

/* --- Fuentes locales --- */

@font-face {
    font-family: Lora;
    font-style: normal;
    font-weight: 400 700;
    font-display: swap;
    src: url('assets/fonts/lora-variable-latin.woff2') format('woff2');
}

@font-face {
    font-family: Quicksand;
    font-style: normal;
    font-weight: 400 700;
    font-display: swap;
    src: url('assets/fonts/quicksand-variable-latin.woff2') format('woff2');
}

:root {
    /* Fuentes */
    --font-display: lora, serif;
    --font-body: quicksand, sans-serif;

    /* Tema base — biblioteca cálida */
    --color-fondo: #f5ead6;
    --color-superficie: #efe0c8;
    --color-oscuro: #d4c4a8;
    --color-accent: #c8864a;
    --color-accent-hover: #a06830;
    --color-texto: #3a2a1a;
    --color-texto-secundario: #6b5a4a;
    --color-texto-tenue: #8a7a6a;
    --color-texto-apagado: #9a8a7a;
    --color-texto-muy-apagado: #aa9a8a;
    --color-borde: #c8b89a;
    --color-borde-claro: #d8c8aa;
    --color-dorado: #c8a050;

    /* Radios */
    --radio-tarjeta: 15px;
    --radio-boton: 8px;
}

/* Tema oscuro original para modo juego (habitaciones) */
body.modo-juego #biblioteca {
    display: none;
}

body.modo-juego {
    --color-fondo: #1a1a2e;
    --color-superficie: #16213e;
    --color-oscuro: #0d0d1a;
    --color-accent: #e94560;
    --color-accent-hover: #c73652;
    --color-texto: #e0e0e0;
    --color-texto-secundario: #a0a0b0;
    --color-texto-tenue: #888;
    --color-texto-apagado: #666;
    --color-texto-muy-apagado: #555;
    --color-borde: #333;
    --color-borde-claro: #444;
    --color-dorado: #ffd700;
}

html {
    overflow: hidden;
    overscroll-behavior: none;
}

body {
    margin: 0;
    padding: 0;
    background-color: var(--color-fondo);
    color: var(--color-texto);
    font-family: var(--font-body);
    overflow: hidden;
    height: 100dvh;
}

#juego {
    max-width: 800px;
    margin: 0 auto;
    padding: 12px 20px;
    text-align: center;
    height: 100dvh;
    display: flex;
    flex-direction: column;
    box-sizing: border-box;
}

#juego.juego-inmersivo {
    max-width: none;
    padding: 10px;
}

#juego.juego-inmersivo .barra-superior {
    max-width: var(--ancho-3d);
    margin-inline: auto;
}

h1 {
    font-family: var(--font-display);
    font-size: 2.5rem;
    color: white;
    letter-spacing: 0.04em;
}

/* --- Avatares (libros) --- */

.avatar {
    font-size: 4rem;
    margin-bottom: 10px;
    display: inline-block;
}

.avatar img {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid var(--color-texto-muy-apagado);
}

/* --- Colores por personaje --- */

/* Lina - paleta morada */
.personaje-lina {
    --v-color: #bb86fc;
    --v-oscuro: #9b59b6;
    --v-glow: rgb(187 134 252 / 40%);
    --v-tenue: rgb(187 134 252 / 12%);

    border-color: #4a1a6b;
    background-color: #1a0a2e;
}

.personaje-lina h3 {
    color: #bb86fc;
}

.personaje-lina .avatar img {
    border-color: #9b59b6;
}

/* Rosé - paleta verde */
.personaje-rose {
    --v-color: #6bfc86;
    --v-oscuro: #2ecc71;
    --v-glow: rgb(107 252 134 / 40%);
    --v-tenue: rgb(107 252 134 / 12%);

    border-color: #1a6b2a;
    background-color: #0a2e14;
}

.personaje-rose h3 {
    color: #6bfc86;
}

.personaje-rose .avatar img {
    border-color: #2ecc71;
}

/* Hana - paleta rosa/fucsia */
.personaje-hana {
    --v-color: #fc86d4;
    --v-oscuro: #e91e90;
    --v-glow: rgb(252 134 212 / 40%);
    --v-tenue: rgb(252 134 212 / 12%);

    border-color: #6b1a5a;
    background-color: #2e0a28;
}

.personaje-hana h3 {
    color: #fc86d4;
}

.personaje-hana .avatar img {
    border-color: #e91e90;
}

/* DonBu - paleta marrón/ámbar */
.personaje-donbu {
    --v-color: #e6b86a;
    --v-oscuro: #d4a052;
    --v-glow: rgb(230 184 106 / 40%);
    --v-tenue: rgb(230 184 106 / 12%);

    border-color: #6b4a1a;
    background-color: #2e1a0a;
}

.personaje-donbu h3 {
    color: #fcca6b;
}

.personaje-donbu .avatar img {
    border-color: #d4a052;
}

/* Kira - paleta teal/púrpura */
.personaje-kira {
    --v-color: #3dd8c8;
    --v-oscuro: #2ec4b6;
    --v-glow: rgb(61 216 200 / 40%);
    --v-tenue: rgb(61 216 200 / 12%);

    border-color: #1a5a5a;
    background-color: #0a2020;
}

.personaje-kira h3 {
    color: #5eeadb;
}

.personaje-kira .avatar img {
    border-color: #2ec4b6;
}

/* PandaJuro - paleta azul con rojo */
.personaje-pandajuro {
    --v-color: #e74c3c;
    --v-oscuro: #c0392b;
    --v-glow: rgb(231 76 60 / 40%);
    --v-tenue: rgb(231 76 60 / 12%);

    border-color: #1a3a6b;
    background-color: #0a1430;
}

.personaje-pandajuro h3 {
    color: #6bb5fc;
}

.personaje-pandajuro .avatar img {
    border-color: #c0392b;
}

/* PomPom - paleta rosa/crema */
.personaje-pompom {
    --v-color: #fcc2d7;
    --v-oscuro: #f8a5c2;
    --v-glow: rgb(252 194 215 / 40%);
    --v-tenue: rgb(252 194 215 / 12%);

    border-color: #7a4a5a;
    background-color: #2a1520;
}

.personaje-pompom h3 {
    color: #fcc2d7;
}

.personaje-pompom .avatar img {
    border-color: #f8a5c2;
}

/* Orejas - paleta naranja/tierra */
.personaje-orejas {
    --v-color: #f0a04b;
    --v-oscuro: #e67e22;
    --v-glow: rgb(240 160 75 / 40%);
    --v-tenue: rgb(240 160 75 / 12%);

    border-color: #6b3a0a;
    background-color: #2a1505;
}

.personaje-orejas h3 {
    color: #f0a04b;
}

.personaje-orejas .avatar img {
    border-color: #e67e22;
}

.descripcion {
    font-size: 0.85rem;
    color: var(--color-texto-secundario);
    margin-bottom: 10px;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* --- Stats del personaje en la tarjeta --- */

.stats {
    text-align: left;
    border-top: 1px solid rgb(255 255 255 / 8%);
    padding-top: 10px;
    margin-top: 4px;
}

.stat-label {
    display: block;
    font-size: 0.65rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    color: #9898b0;
    margin-bottom: 4px;
}

/* Barra de vida */
.stat-vida {
    display: grid;
    grid-template-columns: 1fr auto;
    grid-template-rows: auto auto;
    gap: 2px 8px;
    align-items: center;
    margin-bottom: 10px;
}

.stat-vida .stat-label {
    grid-column: 1 / -1;
}

.barra-vida-fondo {
    height: 6px;
    background-color: rgb(255 255 255 / 8%);
    border-radius: 3px;
    overflow: hidden;
}

.barra-vida-relleno {
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, #e94560, #ff6b81);
    border-radius: 3px;
    transform-origin: left;
    transition: transform 0.3s;
}

.stat-valor {
    font-size: 0.8rem;
    font-weight: bold;
    color: #ccc;
}

/* Barra de velocidad */
.stat-velocidad {
    display: grid;
    grid-template-columns: 1fr auto;
    grid-template-rows: auto auto;
    gap: 2px 8px;
    align-items: center;
    margin-bottom: 10px;
}

.stat-velocidad .stat-label {
    grid-column: 1 / -1;
}

.barra-velocidad-relleno {
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, #f59e0b, #fbbf24);
    border-radius: 3px;
    transform-origin: left;
    transition: transform 0.3s;
}

.stat-vel-ataque {
    display: grid;
    grid-template-columns: 1fr auto;
    grid-template-rows: auto auto;
    gap: 2px 8px;
    align-items: center;
    margin-bottom: 10px;
}

.stat-vel-ataque .stat-label {
    grid-column: 1 / -1;
}

.barra-vel-ataque-relleno {
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, #e05a8a, #f472b6);
    border-radius: 3px;
    transform-origin: left;
    transition: transform 0.3s;
}

/* Ataques */
.stat-atributos {
    margin-top: 6px;
    margin-bottom: 12px;
}

.stat-atributos .tier-badge {
    position: static;
}

.stat-ataques {
    margin-top: 12px;
}

.ataque {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 3px 0;
}

.ataque-nombre {
    font-size: 0.75rem;
    color: #b0b0c0;
}

.ataque-dano {
    font-size: 0.75rem;
    font-weight: bold;
    color: var(--color-accent);
    background-color: rgb(233 69 96 / 12%);
    padding: 1px 6px;
    border-radius: var(--radio-boton);
}

/* Colores de barra de vida por personaje */
.personaje-lina .barra-vida-relleno {
    background: linear-gradient(90deg, #9b59b6, #bb86fc);
}

.personaje-lina .ataque-dano {
    color: #bb86fc;
    background-color: rgb(155 89 182 / 15%);
}

.personaje-rose .barra-vida-relleno {
    background: linear-gradient(90deg, #2ecc71, #6bfc86);
}

.personaje-rose .ataque-dano {
    color: #6bfc86;
    background-color: rgb(46 204 113 / 15%);
}

.personaje-hana .barra-vida-relleno {
    background: linear-gradient(90deg, #e91e90, #fc86d4);
}

.personaje-hana .ataque-dano {
    color: #fc86d4;
    background-color: rgb(233 30 144 / 15%);
}

.personaje-kira .barra-vida-relleno {
    background: linear-gradient(90deg, #2ec4b6, #5eeadb);
}

.personaje-kira .ataque-dano {
    color: #5eeadb;
    background-color: rgb(46 196 182 / 15%);
}

.personaje-donbu .barra-vida-relleno {
    background: linear-gradient(90deg, #d4a052, #fcca6b);
}

.personaje-donbu .ataque-dano {
    color: #fcca6b;
    background-color: rgb(212 160 82 / 15%);
}

.personaje-pompom .barra-vida-relleno {
    background: linear-gradient(90deg, #f8a5c2, #fcc2d7);
}

.personaje-pompom .ataque-dano {
    color: #fcc2d7;
    background-color: rgb(248 165 194 / 15%);
}

.personaje-orejas .barra-vida-relleno {
    background: linear-gradient(90deg, #e67e22, #f0a04b);
}

.personaje-orejas .ataque-dano {
    color: #f0a04b;
    background-color: rgb(230 126 34 / 15%);
}

.personaje-pandajuro .barra-vida-relleno {
    background: linear-gradient(90deg, #c0392b, #6bb5fc);
}

.personaje-pandajuro .ataque-dano {
    color: #6bb5fc;
    background-color: rgb(107 181 252 / 15%);
}

/* --- Sección de villanos --- */

.villano {
    position: relative;
    background-color: var(--color-superficie);
    border: 3px solid var(--color-borde);
    border-radius: var(--radio-tarjeta);
    padding: 20px;
    width: 200px;
    cursor: default;
    flex-shrink: 0;
    scroll-snap-align: center;
    opacity: 0.75;
    transition: opacity 0.3s;
}

.villano:hover {
    opacity: 1;
}

/* Badge de tier */
.tier-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 0.6rem;
    font-weight: 700;
    letter-spacing: 0.05em;
    padding: 2px 8px;
    border-radius: 20px;
    line-height: 1.4;
}

.tier-esbirro {
    background-color: rgb(80 80 80 / 40%);
    color: #aaa;
}

.tier-elite {
    background-color: rgb(168 85 247 / 20%);
    color: #c084fc;
}

.tier-pesadilla {
    background-color: rgb(239 68 68 / 20%);
    color: #f87171;
}

.tier-leyenda {
    background-color: rgb(245 158 11 / 20%);
    color: #fbbf24;
}

.villano h3 {
    font-family: var(--font-display);
    color: #999;
    margin: 5px 0;
    font-size: 1.3rem;
}

.villano .descripcion {
    font-size: 0.85rem;
    color: #777;
}

.avatar-emoji {
    font-size: 4rem;
    display: block;
    line-height: 1;
}

/* Siniestra — rojo/negro */
.villano-siniestra {
    --v-color: #f44;
    --v-oscuro: #8b0000;
    --v-glow: rgb(255 50 50 / 40%);
    --v-tenue: rgb(255 68 68 / 12%);

    border-color: #4a0a0a;
    background-color: #1a0808;
}

.villano-siniestra h3 {
    color: #f44;
}

.villano-siniestra .avatar img {
    border-color: #8b0000;
    box-shadow: 0 0 10px rgb(255 50 50 / 40%);
}

.villano-siniestra .barra-vida-relleno {
    background: linear-gradient(90deg, #8b0000, #f44);
}

.villano-siniestra .ataque-dano {
    color: #f44;
    background-color: rgb(255 68 68 / 15%);
}

/* Trasgo — negro/gris */
.villano-trasgo {
    --v-color: #888;
    --v-oscuro: #555;
    --v-glow: rgb(150 150 150 / 30%);
    --v-tenue: rgb(150 150 150 / 12%);

    border-color: #333;
    background-color: #111118;
}

.villano-trasgo h3 {
    color: #888;
}

.villano-trasgo .avatar img {
    border-color: #555;
    box-shadow: 0 0 8px rgb(150 150 150 / 30%);
}

.villano-trasgo .barra-vida-relleno {
    background: linear-gradient(90deg, #444, #888);
}

.villano-trasgo .ataque-dano {
    color: #999;
    background-color: rgb(150 150 150 / 15%);
}

/* El Profano — azul/negro */
.villano-profano {
    --v-color: #48c;
    --v-oscuro: #1a3a6b;
    --v-glow: rgb(50 100 200 / 40%);
    --v-tenue: rgb(68 136 204 / 12%);

    border-color: #0a1a3a;
    background-color: #080e1a;
}

.villano-profano h3 {
    color: #48c;
}

.villano-profano .avatar img {
    border-color: #1a3a6b;
    box-shadow: 0 0 10px rgb(50 100 200 / 40%);
}

.villano-profano .barra-vida-relleno {
    background: linear-gradient(90deg, #1a2a4a, #48c);
}

.villano-profano .ataque-dano {
    color: #48c;
    background-color: rgb(68 136 204 / 15%);
}

/* El Errante — verde/negro */
.villano-errante {
    --v-color: #4c4;
    --v-oscuro: #2a6b2a;
    --v-glow: rgb(50 200 50 / 40%);
    --v-tenue: rgb(68 204 68 / 12%);

    border-color: #0a4a0a;
    background-color: #081a08;
}

.villano-errante h3 {
    color: #4c4;
}

.villano-errante .avatar img {
    border-color: #2a6b2a;
    box-shadow: 0 0 10px rgb(50 200 50 / 40%);
}

.villano-errante .barra-vida-relleno {
    background: linear-gradient(90deg, #1a6b1a, #4c4);
}

.villano-errante .ataque-dano {
    color: #4c4;
    background-color: rgb(68 204 68 / 15%);
}

/* Topete — púrpura/magenta */
.villano-topete {
    --v-color: #c050d0;
    --v-oscuro: #6a1b7a;
    --v-glow: rgb(192 80 208 / 40%);
    --v-tenue: rgb(192 80 208 / 12%);

    border-color: #3a0a4a;
    background-color: #12081a;
}

.villano-topete h3 {
    color: #c050d0;
}

.villano-topete .avatar img {
    border-color: #6a1b7a;
    box-shadow: 0 0 10px rgb(192 80 208 / 40%);
}

.villano-topete .barra-vida-relleno {
    background: linear-gradient(90deg, #6a1b7a, #c050d0);
}

.villano-topete .ataque-dano {
    color: #c050d0;
    background-color: rgb(192 80 208 / 15%);
}

/* Pototo — rosa/magenta */
.villano-pototo {
    --v-color: #e060a0;
    --v-oscuro: #8b1a5a;
    --v-glow: rgb(224 96 160 / 40%);
    --v-tenue: rgb(224 96 160 / 12%);

    border-color: #4a0a2a;
    background-color: #1a0812;
}

.villano-pototo h3 {
    color: #e060a0;
}

.villano-pototo .avatar img {
    border-color: #8b1a5a;
    box-shadow: 0 0 10px rgb(224 96 160 / 40%);
}

.villano-pototo .barra-vida-relleno {
    background: linear-gradient(90deg, #8b1a5a, #e060a0);
}

.villano-pototo .ataque-dano {
    color: #e060a0;
    background-color: rgb(224 96 160 / 15%);
}

/* La Grotesca — vino/púrpura oscuro */
.villano-grotesca {
    --v-color: #a8325a;
    --v-oscuro: #5c1a30;
    --v-glow: rgb(168 50 90 / 40%);
    --v-tenue: rgb(168 50 90 / 12%);

    border-color: #3a0a1a;
    background-color: #150810;
}

.villano-grotesca h3 {
    color: #a8325a;
}

.villano-grotesca .avatar img {
    border-color: #5c1a30;
    box-shadow: 0 0 10px rgb(168 50 90 / 40%);
}

.villano-grotesca .barra-vida-relleno {
    background: linear-gradient(90deg, #5c1a30, #a8325a);
}

.villano-grotesca .ataque-dano {
    color: #a8325a;
    background-color: rgb(168 50 90 / 15%);
}

/* El Disonante — ámbar/siena */
.villano-disonante {
    --v-color: #c89030;
    --v-oscuro: #6e4e18;
    --v-glow: rgb(200 144 48 / 40%);
    --v-tenue: rgb(200 144 48 / 12%);

    border-color: #3a2a0e;
    background-color: #1a1408;
}

.villano-disonante h3 {
    color: #c89030;
}

.villano-disonante .avatar img {
    border-color: #6e4e18;
    box-shadow: 0 0 10px rgb(200 144 48 / 40%);
}

.villano-disonante .barra-vida-relleno {
    background: linear-gradient(90deg, #6e4e18, #c89030);
}

.villano-disonante .ataque-dano {
    color: #c89030;
    background-color: rgb(200 144 48 / 15%);
}

/* --- Modal de salir (confirmación para volver al menú) --- */

#modal-salir {
    position: fixed;
    inset: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
}

#modal-salir .modal-contenido {
    --modal-accent: #f0a500;
    --modal-fondo: #3e2e0a;
}

.modal-salir-linea {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    border-radius: 15px 15px 0 0;
    background: var(--modal-accent);
    box-shadow: 0 0 12px var(--modal-accent);
}

.modal-salir-icono {
    font-size: 3rem;
    line-height: 1;
    margin: 4px 0 8px;
    animation: flotar-icono 2.5s ease-in-out infinite;
}

.modal-salir-btn-confirmar {
    padding: 10px 30px;
    font-size: 1rem;
    border: 2px solid var(--modal-accent);
    border-radius: var(--radio-boton);
    cursor: pointer;
    background-color: transparent;
    color: var(--modal-accent);
    transition:
        background-color 0.3s,
        color 0.3s;
}

.modal-salir-btn-confirmar:hover {
    background-color: var(--modal-accent);
    color: #1a1a2e;
}

.modal-salir-btn-cancelar {
    padding: 10px 30px;
    font-size: 1rem;
    border: none;
    border-radius: var(--radio-boton);
    cursor: pointer;
    background-color: var(--modal-accent);
    color: #1a1a2e;
    font-weight: bold;
    transition: filter 0.2s;
}

.modal-salir-btn-cancelar:hover {
    filter: brightness(0.85);
}

/* --- Modal de derrota --- */

.modal-derrota {
    position: absolute;
    inset: 0;
    z-index: 50;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-derrota-fondo {
    position: absolute;
    inset: 0;
    background-color: rgb(10 0 0 / 85%);
    animation: derrota-fondo-aparecer 0.5s ease;
}

@keyframes derrota-fondo-aparecer {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

.modal-derrota-caja {
    position: relative;
    background: linear-gradient(180deg, #1a0a0a 0%, #0d0d1a 100%);
    border: 2px solid #8b0000;
    border-radius: 12px;
    padding: 24px 32px;
    text-align: center;
    box-shadow:
        0 0 30px rgb(139 0 0 / 40%),
        inset 0 0 20px rgb(0 0 0 / 50%);
    animation: derrota-caja-aparecer 0.4s ease;
    max-width: min(280px, 85vw);
}

@keyframes derrota-caja-aparecer {
    from {
        transform: scale(0.8);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

.modal-derrota-caja h2 {
    font-family: var(--font-display);
    color: #c33;
    font-size: 1.2rem;
    margin: 0 0 6px;
    text-shadow: 0 0 12px rgb(200 50 50 / 50%);
}

.modal-derrota-caja p {
    color: #999;
    font-size: 0.85rem;
    margin: 0 0 18px;
}

.modal-derrota-icono {
    font-size: 2.5rem;
    margin-bottom: 8px;
    animation: derrota-pulso 2s ease-in-out infinite;
}

@keyframes derrota-pulso {
    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.1);
    }
}

.modal-derrota-btn {
    padding: 10px 28px;
    font-size: 0.9rem;
    font-weight: bold;
    color: #fff;
    background: linear-gradient(180deg, #8b0000 0%, #5a0000 100%);
    border: 2px solid #a22;
    border-radius: 8px;
    cursor: pointer;
    text-shadow: 0 1px 2px rgb(0 0 0 / 50%);
    box-shadow: 0 2px 8px rgb(139 0 0 / 30%);
    transition:
        transform 0.15s,
        box-shadow 0.15s,
        background 0.2s;
}

.modal-derrota-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgb(139 0 0 / 50%);
    background: linear-gradient(180deg, #a11 0%, #6a0000 100%);
}

.modal-derrota-btn:active {
    transform: translateY(1px);
    box-shadow: 0 1px 4px rgb(139 0 0 / 30%);
}

/* --- Barra superior del jugador --- */

.barra-superior {
    display: flex;
    align-items: center;
    gap: 15px;
    background-color: rgb(15 15 30 / 95%);
    border: 2px solid var(--color-borde);
    border-radius: 10px;
    padding: 8px 15px;
    margin-bottom: 15px;
}

.barra-jugador {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
}

.barra-jugador img {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #888;
}

.barra-jugador span {
    font-size: 0.9rem;
    font-weight: bold;
    color: var(--color-texto);
}

.barra-vida-jugador {
    display: flex;
    align-items: center;
    gap: 8px;
    flex: 1;
    min-width: 100px;
}

.barra-vida-corazon {
    font-size: 0.9rem;
    animation: latido 1.2s ease-in-out infinite;
}

@keyframes latido {
    0%,
    100% {
        transform: scale(1);
    }

    15% {
        transform: scale(1.25);
    }

    30% {
        transform: scale(1);
    }
}

.barra-vida-jugador .barra-vida-fondo {
    flex: 1;
    height: 14px;
    border-radius: 7px;
    position: relative;
}

.barra-vida-jugador .barra-vida-relleno {
    border-radius: 7px;
    transition:
        transform 0.4s ease,
        background 0.4s ease;
    position: relative;
    overflow: hidden;
}

.barra-vida-jugador .barra-vida-relleno::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
        90deg,
        transparent 0%,
        rgb(255 255 255 / 25%) 50%,
        transparent 100%
    );
    animation: shimmer-vida 2.5s ease-in-out infinite;
}

@keyframes shimmer-vida {
    0% {
        transform: translateX(-100%);
    }

    100% {
        transform: translateX(100%);
    }
}

.barra-vida-texto {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.65rem;
    font-weight: bold;
    color: white;
    text-shadow: 0 1px 2px rgb(0 0 0 / 60%);
    z-index: 1;
}

.barra-vida-peligro .barra-vida-corazon {
    animation: latido-rapido 0.5s ease-in-out infinite;
}

@keyframes latido-rapido {
    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.35);
    }
}

.barra-inventario {
    display: flex;
    align-items: center;
    gap: 5px;
    flex-shrink: 0;
}

.inventario-slot {
    width: 28px;
    height: 28px;
    border: 2px solid rgb(255 255 255 / 8%);
    border-radius: 6px;
    background-color: rgb(255 255 255 / 3%);
    display: flex;
    align-items: center;
    justify-content: center;
    transition:
        border-color 0.3s,
        background-color 0.3s,
        box-shadow 0.3s;
}

.inventario-slot-lleno {
    border-color: var(--slot-color);
    background-color: rgb(255 255 255 / 6%);
    box-shadow:
        0 0 8px var(--slot-color),
        inset 0 0 6px rgb(0 0 0 / 30%);
    animation: slot-aparecer 0.4s ease;
}

.inventario-item-img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 4px;
}

@keyframes slot-aparecer {
    0% {
        transform: scale(0.5);
        opacity: 0;
    }

    50% {
        transform: scale(1.2);
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* Colores de borde de avatar según personaje */
.barra-lina .barra-jugador img {
    border-color: #9b59b6;
}

.barra-rose .barra-jugador img {
    border-color: #2ecc71;
}

.barra-pandajuro .barra-jugador img {
    border-color: #c0392b;
}

.barra-hana .barra-jugador img {
    border-color: #e91e90;
}

.barra-kira .barra-jugador img {
    border-color: #2ec4b6;
}

.barra-donbu .barra-jugador img {
    border-color: #d4a052;
}

/* --- Paletas por habitación --- */

.habitacion-1 {
    --hab-pared: #3d2560;
    --hab-pared-medio: #2a1845;
    --hab-pared-oscuro: #201035;
    --hab-borde: rgb(100 60 150 / 25%);
    --hab-accent: #bb86fc;
}

.habitacion-2 {
    --hab-pared: #1a3e1a;
    --hab-pared-medio: #102e10;
    --hab-pared-oscuro: #0d240d;
    --hab-borde: rgb(60 150 80 / 20%);
    --hab-accent: #6bfc86;
}

.habitacion-3 {
    --hab-pared: #3e1a1a;
    --hab-pared-medio: #2e1010;
    --hab-pared-oscuro: #240d0d;
    --hab-borde: rgb(150 60 60 / 20%);
    --hab-accent: #e94560;
}

.habitacion-4 {
    --hab-pared: #1a1a3e;
    --hab-pared-medio: #10102e;
    --hab-pared-oscuro: #0d0d24;
    --hab-borde: rgb(60 80 150 / 20%);
    --hab-accent: #5eeadb;
}

/* Cabecera: botón huir + título en una sola fila */
.cabecera-habitacion {
    display: flex;
    align-items: center;
    gap: 8px;
    margin: 0 0 2px;
    width: 100%;
    justify-content: center;
}

.titulo-habitacion {
    font-family: var(--font-display);
    color: var(--color-accent);
    font-size: 1.3rem;
    margin: 0;
    text-shadow: 0 0 10px rgb(233 69 96 / 50%);
}

/* Botón huir: icono circular con imagen de puerta mágica */
.btn-huir {
    width: 44px;
    height: 44px;
    padding: 0;
    border: 2px solid rgb(240 165 0 / 30%);
    border-radius: 50%;
    cursor: pointer;
    background-color: rgb(240 165 0 / 8%);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    position: relative;
    transition:
        border-color 0.3s,
        background-color 0.3s,
        box-shadow 0.3s,
        transform 0.2s;
}

.btn-huir::after {
    content: '';
    position: absolute;
    inset: -3px;
    border-radius: 50%;
    border: 1px solid rgb(240 165 0 / 0%);
    transition: border-color 0.3s;
    pointer-events: none;
}

.btn-huir:hover {
    border-color: rgb(240 165 0 / 60%);
    background-color: rgb(240 165 0 / 15%);
    box-shadow:
        0 0 12px rgb(240 165 0 / 30%),
        0 0 24px rgb(240 165 0 / 10%);
    transform: scale(1.08);
}

.btn-huir:hover::after {
    border-color: rgb(240 165 0 / 20%);
}

.btn-huir:active {
    transform: scale(0.95);
    border-color: rgb(240 165 0 / 80%);
    box-shadow: 0 0 16px rgb(240 165 0 / 40%);
}

.btn-huir-icono {
    width: 32px;
    height: 32px;
    object-fit: contain;
    border-radius: 50%;
    filter: drop-shadow(0 0 4px rgb(240 165 0 / 40%));
    transition: filter 0.3s;
    pointer-events: none;
}

.btn-huir:hover .btn-huir-icono {
    filter: drop-shadow(0 0 8px rgb(240 165 0 / 60%));
}

/* --- Transiciones entre pantallas --- */

.transicion-overlay {
    position: fixed;
    inset: 0;
    z-index: 200;
    pointer-events: none;
    opacity: 0;
}

/* Fade: oscurecer a negro */
.transicion-fade-in {
    background-color: var(--color-oscuro);
    opacity: 0;
    pointer-events: all;
    animation: fade-in 0.4s ease forwards;
}

.transicion-fade-out {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: fade-out 0.4s ease forwards;
}

@keyframes fade-in {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

@keyframes fade-out {
    from {
        opacity: 1;
    }

    to {
        opacity: 0;
    }
}

/* Wipe: cortina horizontal de izquierda a derecha */
.transicion-wipe-in {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: wipe-in 0.4s ease forwards;
}

.transicion-wipe-out {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: wipe-out 0.4s ease forwards;
}

@keyframes wipe-in {
    from {
        clip-path: inset(0 100% 0 0);
    }

    to {
        clip-path: inset(0 0 0 0);
    }
}

@keyframes wipe-out {
    from {
        clip-path: inset(0 0 0 0);
    }

    to {
        clip-path: inset(0 0 0 100%);
    }
}

/* Iris: círculo que se cierra y abre (estilo cartoon) */
.transicion-iris-in {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: iris-in 0.5s ease forwards;
}

.transicion-iris-out {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: iris-out 0.5s ease forwards;
}

@keyframes iris-in {
    from {
        clip-path: circle(100% at 50% 50%);
    }

    to {
        clip-path: circle(0% at 50% 50%);
    }
}

@keyframes iris-out {
    from {
        clip-path: circle(0% at 50% 50%);
    }

    to {
        clip-path: circle(100% at 50% 50%);
    }
}

/* --- D-pad virtual (touch) --- */

.dpad-contenedor {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 150;
    display: grid;
    grid-template:
        '.     arriba  .      ' 56px
        'izq   .       der    ' 56px
        '.     abajo   .      ' 56px
        / 56px 56px 56px;
    gap: 0;
}

.dpad-btn {
    position: relative;
    width: 56px;
    height: 56px;
    border: 2px solid rgb(255 255 255 / 15%);
    border-radius: 12px;
    background-color: rgb(15 15 30 / 75%);
    color: rgb(255 255 255 / 60%);
    font-size: 1.2rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    touch-action: none;
    user-select: none;
    transition:
        background-color 0.1s,
        border-color 0.1s;
}

.dpad-btn::before {
    content: '';
    position: absolute;
    inset: -8px;
}

.dpad-btn:active,
.dpad-btn.dpad-activo {
    background-color: rgb(233 69 96 / 40%);
    border-color: var(--color-accent);
    color: white;
}

.dpad-arriba {
    grid-area: arriba;
}

.dpad-izquierda {
    grid-area: izq;
}

.dpad-derecha {
    grid-area: der;
}

.dpad-abajo {
    grid-area: abajo;
}

.dpad-contenedor.dpad-cruz-split {
    left: 20px;
    transform: none;
}

/* --- D-pad split (platformer: izq movimiento / der acciones) --- */

.dpad-izq-contenedor {
    position: fixed;
    bottom: 20px;
    left: 20px;
    z-index: 150;
    display: flex;
    gap: 8px;
}

.dpad-der-contenedor {
    position: fixed;
    bottom: 16px;
    right: 16px;
    z-index: 150;
    display: flex;
    align-items: flex-end;
    gap: 6px;
}

/* Boton A: accion principal (saltar) — grande, destacado */
.dpad-btn-a {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    border-color: rgb(94 234 219 / 50%);
    background-color: rgb(94 234 219 / 15%);
    color: rgb(94 234 219 / 90%);
    font-size: 1.3rem;
    font-weight: 700;
}

.dpad-btn-a:active {
    background-color: rgb(94 234 219 / 40%);
    border-color: #5eeadb;
    color: white;
}

/* Boton B: accion secundaria — mas chico, arriba-izquierda del A */
.dpad-btn-b {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    margin-bottom: 24px;
    font-size: 1rem;
    font-weight: 700;
}

.dpad-btn-b:disabled {
    opacity: 0.25;
    border-style: dashed;
    pointer-events: none;
}

/* Ocultar D-pad en dispositivos sin touch */
@media (hover: hover) and (pointer: fine) {
    .dpad-contenedor,
    .dpad-izq-contenedor,
    .dpad-der-contenedor {
        display: none !important;
    }
}

/* Ocultar D-pad cuando un libro (heroario/villanario) está abierto */
body:has(.libro-modal:not(.oculto)) .dpad-contenedor,
body:has(.libro-modal:not(.oculto)) .dpad-izq-contenedor,
body:has(.libro-modal:not(.oculto)) .dpad-der-contenedor {
    display: none !important;
}

/* --- Overlay "gira tu dispositivo" --- */

.overlay-rotar {
    position: fixed;
    inset: 0;
    z-index: 999;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 16px;
    background: rgb(10 5 20 / 95%);
}

.overlay-rotar-icono {
    font-size: 4rem;
    animation: rotar-icono 2s ease-in-out infinite;
}

.overlay-rotar-mensaje {
    color: rgb(255 255 255 / 85%);
    font-family: var(--font-body);
    font-size: 1.1rem;
    font-weight: 500;
    letter-spacing: 0.03em;
}

@keyframes rotar-icono {
    0%,
    100% {
        transform: rotate(0deg);
    }

    50% {
        transform: rotate(90deg);
    }
}

/* Ocultar overlay en desktop */
@media (hover: hover) and (pointer: fine) {
    .overlay-rotar {
        display: none !important;
    }
}

/* --- Ajustes landscape para modo inmersivo (mobile) --- */

@media (orientation: landscape) and (pointer: coarse) {
    #juego.juego-inmersivo {
        padding: 2px 4px;
    }

    #juego.juego-inmersivo .barra-superior,
    #juego.juego-inmersivo .cabecera-habitacion {
        display: none;
    }
}

/* --- Notificaciones toast --- */

.toast-contenedor {
    position: fixed;

    /* Anclar al borde derecho del área de juego (800px centrado) */
    right: max(10px, calc(50vw - 400px + 10px));
    top: 50%;
    transform: translateY(-50%);
    z-index: 300;
    display: flex;
    flex-direction: column;
    gap: 6px;
    pointer-events: none;
    width: 52px;
    align-items: flex-end;
}

/* En modo inmersivo (habitaciones 3D) el juego es full-width */
#juego.juego-inmersivo ~ .toast-contenedor {
    right: 10px;
}

/* Toast: diseño compacto tipo badge de juego */
.toast {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    padding: 0;
    background-color: rgb(10 10 25 / 90%);
    border: 2px solid var(--toast-color);
    border-radius: 12px;
    box-shadow:
        0 0 12px color-mix(in srgb, var(--toast-color) 50%, transparent),
        0 0 24px color-mix(in srgb, var(--toast-color) 20%, transparent),
        inset 0 1px 0 rgb(255 255 255 / 8%);
    pointer-events: auto;
    cursor: default;
    position: relative;
    animation: toast-entrada 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
    transition:
        opacity 0.3s ease,
        transform 0.3s ease;
}

/* Efecto de resplandor pulsante en el toast activo (el más reciente) */
.toast:last-child {
    animation:
        toast-entrada 0.35s cubic-bezier(0.34, 1.56, 0.64, 1),
        toast-pulso 2s ease-in-out 0.35s infinite;
}

/* Los toasts más viejos se atenúan */
.toast:not(:last-child) {
    opacity: 0.5;
    transform: scale(0.85);
}

.toast-icono {
    font-size: 1.3rem;
    line-height: 1;
    flex-shrink: 0;
    filter: drop-shadow(0 0 4px var(--toast-color));
}

/* Tooltip con el mensaje — aparece al hacer hover */
.toast-mensaje {
    position: absolute;
    right: calc(100% + 8px);
    top: 50%;
    transform: translateY(-50%);
    white-space: nowrap;
    font-size: 0.75rem;
    font-weight: 700;
    color: rgb(255 255 255 / 95%);
    background-color: rgb(10 10 25 / 95%);
    border: 1px solid var(--toast-color);
    border-radius: 8px;
    padding: 6px 12px;
    box-shadow:
        0 4px 12px rgb(0 0 0 / 50%),
        0 0 8px color-mix(in srgb, var(--toast-color) 30%, transparent);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
}

/* Flechita del tooltip */
.toast-mensaje::after {
    content: '';
    position: absolute;
    right: -5px;
    top: 50%;
    transform: translateY(-50%) rotate(45deg);
    width: 8px;
    height: 8px;
    background-color: rgb(10 10 25 / 95%);
    border-right: 1px solid var(--toast-color);
    border-top: 1px solid var(--toast-color);
}

.toast:hover .toast-mensaje {
    opacity: 1;
}

/* En touch el mensaje se muestra brevemente al aparecer */
.toast-mostrar-mensaje .toast-mensaje {
    opacity: 1;
}

@keyframes toast-entrada {
    from {
        transform: translateX(30px) scale(0.5);
        opacity: 0;
    }

    to {
        transform: translateX(0) scale(1);
        opacity: 1;
    }
}

@keyframes toast-pulso {
    0%,
    100% {
        box-shadow:
            0 0 12px color-mix(in srgb, var(--toast-color) 50%, transparent),
            0 0 24px color-mix(in srgb, var(--toast-color) 20%, transparent),
            inset 0 1px 0 rgb(255 255 255 / 8%);
    }

    50% {
        box-shadow:
            0 0 16px color-mix(in srgb, var(--toast-color) 70%, transparent),
            0 0 32px color-mix(in srgb, var(--toast-color) 35%, transparent),
            inset 0 1px 0 rgb(255 255 255 / 12%);
    }
}

.toast.toast-salida {
    animation: toast-salida 0.3s ease forwards;
}

@keyframes toast-salida {
    from {
        transform: translateX(0) scale(1);
        opacity: 1;
    }

    to {
        transform: translateX(20px) scale(0.7);
        opacity: 0;
    }
}

/* --- Utilidades --- */

.oculto {
    display: none !important;
}

/* ============================================================
   LIBRO — Layout base y estilos compartidos (índice + detalle)
   ============================================================ */

/* Layout del libro — clase base para todos los libros */
.libro {
    --v-color: rgb(230 200 160 / 95%);
    --v-oscuro: rgb(180 155 120);
    --v-glow: rgb(230 200 160 / 30%);
    --v-tenue: rgb(230 200 160 / 10%);

    display: flex;
    width: 700px;
    height: 680px;
    max-width: 100%;
    max-height: calc(90vh - 40px);
    margin: 0 auto;
    border-radius: 8px;
    overflow: hidden;
    border: 2px solid rgb(255 215 0 / 25%);
    box-shadow:
        0 8px 32px rgb(0 0 0 / 50%),
        0 0 18px var(--v-glow, rgb(233 69 96 / 15%));
    transition: box-shadow 0.5s;
    background-color: #18120d;
}

.libro-villanos {
    animation: libro-entrada 0.5s ease;
}

@keyframes libro-entrada {
    from {
        opacity: 0;
        transform: scale(0.95);
    }

    to {
        opacity: 1;
        transform: scale(1);
    }
}

/* Páginas */
.libro-pagina {
    padding: 20px;
}

.libro-pagina-izq {
    flex: 0 0 200px;
    background:
        repeating-linear-gradient(135deg, rgb(120 100 70 / 2%) 0, transparent 2px, transparent 8px),
        radial-gradient(ellipse at 20% 80%, rgb(80 60 30 / 8%) 0%, transparent 60%),
        radial-gradient(ellipse at 80% 20%, rgb(60 50 25 / 6%) 0%, transparent 50%),
        linear-gradient(to right, transparent 70%, rgb(0 0 0 / 15%)),
        linear-gradient(135deg, #1c1510 0%, #18120d 50%, #140f0a 100%);
    border-right: none;
    display: flex;
    flex-direction: column;
}

.libro-pagina-der {
    flex: 1;
    position: relative;
    padding: 28px 32px 0;
    background:
        repeating-linear-gradient(135deg, rgb(120 100 70 / 2%) 0, transparent 2px, transparent 8px),
        radial-gradient(ellipse at 70% 30%, rgb(80 60 30 / 8%) 0%, transparent 60%),
        radial-gradient(ellipse at 30% 70%, rgb(60 50 25 / 6%) 0%, transparent 50%),
        linear-gradient(to left, transparent 70%, rgb(0 0 0 / 12%)),
        linear-gradient(135deg, #1c1510 0%, #18120d 50%, #140f0a 100%);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* Tintado suave en página derecha */
.libro-pagina-der::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(
        ellipse at center 30%,
        var(--v-tenue, transparent) 0%,
        transparent 70%
    );
    pointer-events: none;
    z-index: 0;
}

/* Lomo decorativo — cuero cálido */
.libro-lomo {
    flex: 0 0 22px;
    background: linear-gradient(
        90deg,
        #1a1008 0%,
        #2a1c10 30%,
        #3a2818 50%,
        #2a1c10 70%,
        #1a1008 100%
    );
    box-shadow:
        inset 2px 0 6px rgb(0 0 0 / 50%),
        inset -2px 0 6px rgb(0 0 0 / 50%);
    display: flex;
    flex-direction: column;
    justify-content: space-evenly;
    padding: 20px 0;
}

/* Costuras doradas del lomo */
.libro-lomo-costura {
    height: 1px;
    margin: 0 3px;
    background: linear-gradient(
        90deg,
        transparent,
        rgb(255 215 0 / 30%),
        rgb(255 215 0 / 50%),
        rgb(255 215 0 / 30%),
        transparent
    );
}

/* Título del libro — dorado */
.libro-titulo {
    font-family: var(--font-display);
    color: var(--color-dorado);
    font-size: 1.15rem;
    text-align: left;
    padding-left: 10px;
    margin: 0 0 8px;
    text-shadow:
        0 0 8px rgb(255 215 0 / 30%),
        0 1px 2px rgb(0 0 0 / 60%);
}

/* Subtítulo del libro */
.libro-subtitulo {
    font-family: var(--font-display);
    color: rgb(255 215 0 / 50%);
    font-size: 0.75rem;
    text-align: left;
    padding-left: 10px;
    margin: -4px 0 8px;
    font-style: italic;
    letter-spacing: 0.5px;
}

/* Ornamentos decorativos — dorados con diamante */
.libro-ornamento {
    height: 1px;
    background: linear-gradient(90deg, transparent, rgb(255 215 0 / 30%), transparent);
    margin: 6px 0;
    position: relative;
}

.libro-ornamento::after {
    content: '\25C6';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 0.5rem;
    color: rgb(255 215 0 / 40%);
    line-height: 1;
}

/* Índice */
.libro-indice {
    list-style: none;
    padding: 0;
    margin: 8px 0;
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.libro-indice-item {
    padding: 8px 10px;
    font-size: 0.8rem;
    color: rgb(180 165 140);
    border-radius: 6px;
    border-left: 2px solid transparent;
    cursor: pointer;
    text-align: left;
    transition:
        background-color 0.2s,
        color 0.2s,
        border-color 0.2s;
    outline: none;
}

.libro-indice-item:hover {
    background-color: rgb(255 255 255 / 5%);
    color: rgb(220 200 170);
}

.libro-indice-item:focus-visible {
    outline: 2px dashed rgb(255 215 0 / 40%);
    outline-offset: -2px;
}

.libro-indice-activo {
    background-color: rgb(255 215 0 / 10%);
    color: var(--color-dorado);
    border-left-color: var(--color-dorado);
    font-weight: bold;
}

/* Separador entre tiers — línea dorada con diamante */
.libro-indice-sep {
    height: 1px;
    background: linear-gradient(90deg, transparent, rgb(255 215 0 / 25%), transparent);
    margin: 6px 8px;
    position: relative;
    pointer-events: none;
}

.libro-indice-sep::after {
    content: '\25C6';
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    font-size: 0.45rem;
    color: rgb(255 215 0 / 40%);
    background: #18120d;
    padding: 0 4px;
    line-height: 1;
}

/* Contenido del detalle */
.libro-detalle-wrap {
    flex: 1;
    min-height: 0;
    position: relative;
    z-index: 1;
    display: flex;
    flex-direction: column;
    perspective: 1200px;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: rgb(255 215 0 / 25%) transparent;
}

.libro-detalle-contenido {
    text-align: center;
    padding: 12px 20px;
    display: flex;
    flex-direction: column;
    height: 100%;
}

/* --- Tabs Perfil / Habilidades --- */
.libro-tabs {
    display: flex;
    justify-content: center;
    gap: 4px;
    margin-bottom: 10px;
}

.libro-tab {
    background: none;
    border: none;
    border-bottom: 2px solid transparent;
    color: rgb(180 165 140 / 50%);
    font-family: var(--font-display);
    font-size: 0.75rem;
    padding: 4px 14px;
    cursor: pointer;
    letter-spacing: 0.05em;
    transition:
        color 0.2s,
        border-color 0.2s;
}

.libro-tab:hover {
    color: rgb(200 185 160);
}

.libro-tab-activo {
    color: var(--v-color, var(--color-dorado));
    border-bottom-color: var(--v-color, var(--color-dorado));
}

/* --- Paneles --- */
.libro-panel {
    display: none;
}

.libro-panel-activo {
    display: flex;
    flex-direction: column;
    flex: 1;
    animation: libro-panel-entrada 0.25s ease;
}

@keyframes libro-panel-entrada {
    from {
        opacity: 0;
        transform: translateY(4px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.libro-detalle-contenido .avatar {
    margin-bottom: 4px;
}

/* Avatar mini para panel de habilidades */
.libro-avatar-mini img {
    width: 48px;
    height: 48px;
}

.libro-detalle-contenido .avatar img {
    width: 120px;
    height: 120px;
}

.libro-detalle-cabecera {
    margin-bottom: 4px;
}

.libro-detalle-cabecera h3 {
    font-family: var(--font-display);
    color: var(--v-color, #999);
    font-size: 1.4rem;
    margin: 4px 0 2px;
    text-shadow: 0 0 10px var(--v-glow, transparent);
    transition:
        color 0.5s,
        text-shadow 0.5s;
}

/* Insignia de rango en perfil de villano */

.villano-rango-insignia {
    align-self: center;
    font-size: 0.55rem;
    font-weight: 600;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 1px 8px;
    border-radius: 10px;
    border: 1px solid rgb(255 255 255 / 6%);
    margin-bottom: 2px;
}

.villano-rango-esbirro {
    background: rgb(80 80 80 / 50%);
    color: #bbb;
}

.villano-rango-elite {
    background: rgb(168 85 247 / 18%);
    color: #c084fc;
    border-color: rgb(168 85 247 / 15%);
}

.villano-rango-pesadilla {
    background: rgb(239 68 68 / 18%);
    color: #f87171;
    border-color: rgb(239 68 68 / 15%);
}

.villano-rango-leyenda {
    background: rgb(245 158 11 / 20%);
    color: #fbbf24;
    border-color: rgb(245 158 11 / 18%);
}

/* Descripción grande (panel perfil) */
.libro-descripcion-grande {
    display: block;
    -webkit-line-clamp: unset;
    font-size: 0.9rem;
    line-height: 1.6;
    color: rgb(210 195 170);
    font-style: italic;
    text-align: left;
    margin: 8px 0 0;
    white-space: pre-line;
    flex: 1;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: rgb(255 215 0 / 25%) transparent;
}

.libro-descripcion-grande::-webkit-scrollbar {
    width: 4px;
}

.libro-descripcion-grande::-webkit-scrollbar-track {
    background: transparent;
}

.libro-descripcion-grande::-webkit-scrollbar-thumb {
    background: rgb(255 215 0 / 25%);
    border-radius: 2px;
}

.libro-descripcion-grande::-webkit-scrollbar-thumb:hover {
    background: rgb(255 215 0 / 40%);
}

.libro-detalle-contenido .stats {
    text-align: left;
    padding-top: 0;
}

/* Esquinas ornamentales doradas */
.libro-esquina {
    position: absolute;
    width: 20px;
    height: 20px;
    opacity: 0.4;
    pointer-events: none;
    z-index: 1;
    transition: opacity 0.3s;
}

.libro:hover .libro-esquina {
    opacity: 0.7;
}

.libro-esquina-tl {
    top: 8px;
    left: 8px;
    border-top: 2px solid rgb(255 215 0 / 50%);
    border-left: 2px solid rgb(255 215 0 / 50%);
}

.libro-esquina-tr {
    top: 8px;
    right: 8px;
    border-top: 2px solid rgb(255 215 0 / 50%);
    border-right: 2px solid rgb(255 215 0 / 50%);
}

.libro-esquina-bl {
    bottom: 8px;
    left: 8px;
    border-bottom: 2px solid rgb(255 215 0 / 50%);
    border-left: 2px solid rgb(255 215 0 / 50%);
}

.libro-esquina-br {
    bottom: 8px;
    right: 8px;
    border-bottom: 2px solid rgb(255 215 0 / 50%);
    border-right: 2px solid rgb(255 215 0 / 50%);
}

/* Page curl — puntita inferior derecha */
.libro-page-curl {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 40px;
    height: 40px;
    z-index: 4;
    pointer-events: none;
    border-radius: 0 0 8px;
    transform-origin: bottom right;
    animation: page-curl-idle 4s ease-in-out infinite;
}

/* Reverso de la página (color crema claro) */
.libro-page-curl::before {
    content: '';
    position: absolute;
    bottom: 0;
    right: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(315deg, #3d3225 0%, #2e2418 40%, #241c12 100%);
    clip-path: polygon(100% 0%, 100% 100%, 0% 100%);
    box-shadow: -3px -3px 6px rgb(0 0 0 / 50%);
}

/* Línea de pliegue diagonal + brillo */
.libro-page-curl::after {
    content: '';
    position: absolute;
    bottom: 0;
    right: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        315deg,
        rgb(255 235 200 / 15%) 0%,
        rgb(255 215 0 / 10%) 30%,
        transparent 50%
    );
    clip-path: polygon(100% 0%, 100% 100%, 0% 100%);
}

@keyframes page-curl-idle {
    0%,
    100% {
        transform: scale(1) rotate(0deg);
    }

    50% {
        transform: scale(1.15) rotate(-2deg) translate(-2px, -2px);
    }
}

/* Volteo 3D de página */
@keyframes libro-flip-out {
    0% {
        transform: rotateY(0deg);
        opacity: 1;
        box-shadow: -4px 0 16px rgb(0 0 0 / 0%);
    }

    40% {
        opacity: 1;
        box-shadow: -20px 0 30px rgb(0 0 0 / 40%);
    }

    100% {
        transform: rotateY(-90deg);
        opacity: 0;
        box-shadow: -2px 0 8px rgb(0 0 0 / 0%);
    }
}

@keyframes libro-flip-in {
    0% {
        transform: rotateY(90deg);
        opacity: 0;
        box-shadow: 20px 0 30px rgb(0 0 0 / 0%);
    }

    40% {
        opacity: 1;
        box-shadow: 20px 0 30px rgb(0 0 0 / 40%);
    }

    100% {
        transform: rotateY(0deg);
        opacity: 1;
        box-shadow: 0 0 0 rgb(0 0 0 / 0%);
    }
}

.libro-fade-out {
    transform-origin: left center;
    animation: libro-flip-out 0.3s ease-in forwards;
}

.libro-fade-in {
    transform-origin: right center;
    animation: libro-flip-in 0.35s ease-out;
}

/* Volteo inverso (página hacia atrás) */
.libro-fade-out-rev {
    transform-origin: right center;
    animation: libro-flip-in 0.3s ease-in reverse forwards;
}

.libro-fade-in-rev {
    transform-origin: left center;
    animation: libro-flip-out 0.35s ease-out reverse;
}

/* Navegación */
.libro-navegacion {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 10px 0 12px;
    flex-shrink: 0;
    border-top: 1px solid rgb(255 215 0 / 10%);
    z-index: 2;
}

.libro-nav-btn {
    width: 32px;
    height: 32px;
    border: 2px solid rgb(255 215 0 / 20%);
    border-radius: 50%;
    background-color: transparent;
    color: rgb(200 185 160);
    font-size: 1.1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition:
        border-color 0.2s,
        color 0.2s,
        background-color 0.2s;
}

.libro-nav-btn:hover:not(:disabled) {
    border-color: var(--v-color, var(--color-accent));
    color: var(--v-color, var(--color-accent));
    background-color: var(--v-tenue, rgb(233 69 96 / 10%));
}

.libro-nav-btn:disabled {
    opacity: 0.25;
    cursor: default;
}

.libro-nav-contador {
    font-size: 0.75rem;
    color: rgb(180 165 140);
    font-style: italic;
    min-width: 40px;
    text-align: center;
}

/* --- Colores del índice del Heroario --- */
.libro-heroes .libro-titulo {
    color: rgb(230 200 160 / 95%);
    text-shadow:
        0 0 8px rgb(230 200 160 / 20%),
        0 1px 2px rgb(0 0 0 / 60%);
}

.libro-heroes .libro-subtitulo {
    color: rgb(220 205 180 / 70%);
}

/* Variables de color para páginas sin entidad activa (inicio y habitaciones) */
.libro-en-inicio,
.libro-en-extra {
    --v-color: rgb(230 200 160 / 95%);
    --v-oscuro: rgb(180 155 120);
    --v-glow: rgb(230 200 160 / 30%);
    --v-tenue: rgb(230 200 160 / 10%);
}

/* Item de inicio en el índice */
.libro-indice-inicio {
    font-style: italic;
    font-size: 0.7rem;
    letter-spacing: 0.04em;
}

/* Subtítulo de sección en el índice */
.libro-indice-seccion {
    font-size: 0.58rem;
    font-family: var(--font-display);
    color: rgb(255 215 0 / 50%);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 4px 8px 2px;
    pointer-events: none;
    list-style: none;
}

/* Tabs de sección e indicador de scroll (ocultos en desktop) */
.libro-indice-secciones {
    display: none;
}

.libro-scroll-hint {
    display: none;
}

/* --- Página de prólogo (compartida por todos los libros) --- */
.libro-intro {
    text-align: center;
    padding: 20px 24px;
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100%;
}

.libro-intro-game-titulo {
    font-family: var(--font-display);
    font-size: 1.5rem;
    color: white;
    letter-spacing: 0.04em;
    margin: 0 0 8px;
    line-height: 1.3;
}

.libro-intro-texto {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 14px;
    max-width: 290px;
}

.libro-intro-texto p {
    font-size: 0.88rem;
    line-height: 1.6;
    color: rgb(220 205 180 / 95%);
}

.libro-intro-link {
    color: rgb(230 200 160 / 90%);
    text-decoration: underline;
    text-decoration-color: rgb(230 200 160 / 30%);
    text-underline-offset: 3px;
    cursor: pointer;
    transition:
        color 0.2s,
        text-decoration-color 0.2s;
}

.libro-intro-link:hover {
    color: rgb(255 220 170);
    text-decoration-color: rgb(255 220 170 / 60%);
}

.libro-intro-cta {
    color: rgb(240 210 150 / 95%) !important;
    font-family: var(--font-display);
    font-size: 0.92rem !important;
    margin-top: 4px;
}

/* --- Lista de rangos (Villanario) --- */

.libro-rangos-lista {
    display: flex;
    flex-direction: column;
    gap: 14px;
    margin-top: 8px;
    text-align: left;
}

.libro-rango-fila {
    display: flex;
    align-items: center;
    gap: 12px;
}

.libro-rango-emoji {
    font-size: 1.3rem;
    line-height: 1;
    flex-shrink: 0;
    width: 28px;
    text-align: center;
}

.libro-rango-nombre {
    color: rgb(240 210 150 / 95%);
    font-family: var(--font-display);
    font-size: 0.88rem;
}

.libro-rango-desc {
    font-size: 0.78rem;
    line-height: 1.45;
    color: rgb(220 205 180 / 75%);
    margin: 1px 0 0;
}

/* --- Páginas de habitaciones (descripción de juegos) --- */
.libro-habitacion {
    text-align: center;
    padding: 16px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100%;
}

.libro-habitacion-img {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid var(--color-dorado);
    box-shadow: 0 0 15px rgb(255 215 0 / 20%);
    margin-bottom: 8px;
}

.libro-habitacion-icono {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background: rgb(255 215 0 / 8%);
    border: 3px solid rgb(255 215 0 / 25%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    margin-bottom: 8px;
}

.libro-habitacion-nombre {
    font-family: var(--font-display);
    font-size: 1.3rem;
    color: white;
    margin: 0 0 4px;
    line-height: 1.3;
}

.libro-habitacion-nivel {
    display: inline-block;
    background: rgb(255 215 0 / 12%);
    color: var(--color-dorado);
    font-family: var(--font-display);
    font-size: 0.68rem;
    padding: 2px 12px;
    border-radius: 10px;
    letter-spacing: 0.06em;
    margin-bottom: 6px;
}

.libro-habitacion-desc {
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-width: 280px;
}

.libro-habitacion-desc p {
    font-size: 0.84rem;
    line-height: 1.55;
    color: rgb(220 205 180 / 90%);
}

.libro-habitacion-tip {
    background: rgb(255 215 0 / 8%);
    border-left: 2px solid rgb(255 215 0 / 30%);
    padding: 8px 12px;
    border-radius: 0 6px 6px 0;
    font-size: 0.78rem;
    color: rgb(240 220 170 / 85%);
    line-height: 1.5;
    text-align: left;
    max-width: 280px;
    margin-top: 4px;
}

.libro-habitacion-tip-icono {
    margin-right: 4px;
}

/* --- Botón flotante del libro --- */

.libro-boton {
    margin-left: auto;
    margin-top: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 8px;
    animation: libro-levitar 3s ease-in-out infinite;
}

.libro-boton img {
    width: 90px;
    height: 90px;
    border-radius: 12px;
    object-fit: cover;
    animation: libro-glow 2.5s ease-in-out infinite alternate;
}

.libro-boton-texto {
    font-family: var(--font-display);
    font-size: 0.85rem;
    color: var(--color-texto-secundario);
    text-shadow: 0 1px 4px rgb(0 0 0 / 60%);
    transition: color 0.3s;
}

.libro-boton:hover {
    animation-duration: 2s;
}

.libro-boton:hover img {
    animation: libro-glow-intenso 1.5s ease-in-out infinite alternate;
}

.libro-boton:hover .libro-boton-texto {
    color: var(--color-accent);
}

.libro-boton:active {
    animation: none;
    transform: translateY(2px) rotate(-6deg);
}

/* Levitación con rotación */
@keyframes libro-levitar {
    0%,
    100% {
        transform: translateY(0) rotate(-6deg);
    }

    50% {
        transform: translateY(-8px) rotate(-6deg);
    }
}

/* Glow normal */
@keyframes libro-glow {
    from {
        filter: drop-shadow(0 4px 8px rgb(0 0 0 / 40%)) drop-shadow(0 0 10px rgb(140 50 180 / 35%));
    }

    to {
        filter: drop-shadow(0 4px 8px rgb(0 0 0 / 40%)) drop-shadow(0 0 16px rgb(233 69 96 / 45%));
    }
}

/* Glow intenso (hover) */
@keyframes libro-glow-intenso {
    from {
        filter: drop-shadow(0 4px 12px rgb(0 0 0 / 50%)) drop-shadow(0 0 20px rgb(140 50 180 / 60%));
    }

    to {
        filter: drop-shadow(0 4px 12px rgb(0 0 0 / 50%)) drop-shadow(0 0 24px rgb(233 69 96 / 70%));
    }
}

/* Chispas mágicas */
.libro-chispas {
    position: absolute;
    inset: -10px;
    pointer-events: none;
}

.libro-chispa {
    position: absolute;
    width: 3px;
    height: 3px;
    border-radius: 50%;
    opacity: 0;
}

.libro-chispa:nth-child(1) {
    left: 15%;
    top: 15%;
    background: rgb(180 80 220);
    box-shadow: 0 0 4px rgb(180 80 220);
    animation: chispa-flotar 2.8s ease-in-out infinite;
}

.libro-chispa:nth-child(2) {
    right: 10%;
    top: 25%;
    background: rgb(233 69 96);
    box-shadow: 0 0 4px rgb(233 69 96);
    animation: chispa-flotar 3.2s ease-in-out infinite 0.5s;
}

.libro-chispa:nth-child(3) {
    left: 50%;
    top: 5%;
    background: rgb(255 210 80);
    box-shadow: 0 0 5px rgb(255 210 80);
    animation: chispa-flotar 2.5s ease-in-out infinite 1s;
}

.libro-chispa:nth-child(4) {
    right: 5%;
    bottom: 35%;
    background: rgb(160 60 200);
    box-shadow: 0 0 4px rgb(160 60 200);
    animation: chispa-flotar 3s ease-in-out infinite 1.5s;
}

.libro-chispa:nth-child(5) {
    left: 5%;
    bottom: 40%;
    background: rgb(233 120 140);
    box-shadow: 0 0 4px rgb(233 120 140);
    animation: chispa-flotar 2.6s ease-in-out infinite 2s;
}

.libro-chispa:nth-child(6) {
    left: 30%;
    bottom: 30%;
    background: rgb(255 180 60);
    box-shadow: 0 0 4px rgb(255 180 60);
    animation: chispa-flotar 3.4s ease-in-out infinite 0.8s;
}

@keyframes chispa-flotar {
    0%,
    100% {
        opacity: 0;
        transform: translateY(0) scale(0.3);
    }

    15% {
        opacity: 1;
        transform: translateY(-5px) scale(1);
    }

    50% {
        opacity: 0.7;
        transform: translateY(-15px) scale(0.8);
    }

    85% {
        opacity: 0;
        transform: translateY(-25px) scale(0.2);
    }
}

/* --- Modal del libro --- */

.libro-modal {
    position: fixed;
    inset: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    overflow: hidden;
}

.libro-modal-fondo {
    position: absolute;
    inset: 0;
    background-color: rgb(0 0 0 / 80%);
}

.libro-modal-cuerpo {
    position: relative;
    animation: modal-aparecer 0.3s ease;
    height: calc(100dvh - 64px);
    max-width: min(700px, calc(100vw - 40px));
    width: 100%;
    overflow: hidden;
    border-radius: 10px;
    border: 2px solid rgb(255 215 0 / 25%);
    display: flex;
    flex-direction: column;
}

.libro-modal-cuerpo .libro {
    border: none;
    border-radius: 0;
    flex: 1;
    height: auto;
    max-height: none;
    min-height: 0;
}

.libro-modal-cerrar {
    position: absolute;
    top: 8px;
    right: 8px;
    z-index: 10;
    width: 36px;
    height: 36px;
    border: 2px solid rgb(255 255 255 / 15%);
    border-radius: 50%;
    background-color: rgb(15 12 20 / 85%);
    color: var(--color-texto-secundario);
    font-size: 1.3rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(6px);
    transition:
        border-color 0.2s,
        color 0.2s,
        background-color 0.2s;
}

.libro-modal-cerrar:hover {
    border-color: var(--color-accent);
    color: var(--color-accent);
    background-color: rgb(233 69 96 / 15%);
}

/* --- Biblioteca (estante) --- */

#biblioteca {
    width: 100%;
    height: 100dvh;
    display: flex;
    align-items: center;
    justify-content: center;
    background:
        radial-gradient(ellipse at 50% 80%, rgb(90 58 26 / 30%) 0%, transparent 70%),
        linear-gradient(180deg, #e8d6b8 0%, #d4c4a8 60%, #c0a888 100%);
}

.estante {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 24px;
    padding: 32px 40px;
    max-width: 600px;
    width: 90%;
}

.estante-titulo {
    font-family: var(--font-display);
    font-size: 2.2rem;
    font-weight: 700;
    color: #5a3a1a;
    text-shadow:
        0 1px 0 rgb(255 255 255 / 40%),
        0 2px 8px rgb(90 58 26 / 20%);
    margin: 0;
    letter-spacing: 0.02em;
}

.estante-repisa {
    display: flex;
    justify-content: center;
    gap: 16px;
    padding: 20px 24px 16px;
    background: linear-gradient(180deg, #8b6b4a 0%, #7a5c3e 40%, #6b4e34 100%);
    border-radius: 8px 8px 12px 12px;
    box-shadow:
        0 6px 20px rgb(0 0 0 / 30%),
        0 2px 0 #5a3e2a,
        inset 0 1px 0 rgb(255 255 255 / 15%);
    border-bottom: 4px solid #4a3020;
    position: relative;
}

.estante-repisa::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 8px;
    right: 8px;
    height: 4px;
    background: linear-gradient(90deg, transparent, rgb(0 0 0 / 15%), transparent);
    border-radius: 0 0 4px 4px;
}

.estante-lomo {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 80px;
    height: 140px;
    border: none;
    border-radius: 4px 6px 6px 4px;
    cursor: pointer;
    position: relative;
    transition:
        transform 0.25s ease,
        box-shadow 0.25s ease;
    background:
        linear-gradient(
            90deg,
            rgb(0 0 0 / 20%) 0%,
            transparent 8%,
            transparent 92%,
            rgb(0 0 0 / 10%) 100%
        ),
        linear-gradient(
            180deg,
            color-mix(in srgb, var(--lomo-color) 90%, white) 0%,
            var(--lomo-color) 50%,
            color-mix(in srgb, var(--lomo-color) 80%, black) 100%
        );
    box-shadow:
        2px 2px 8px rgb(0 0 0 / 30%),
        inset 0 0 0 1px rgb(255 255 255 / 10%);
    font-family: var(--font-display);
}

.estante-lomo:hover,
.estante-lomo:focus-visible {
    transform: translateY(-12px);
    box-shadow:
        2px 8px 20px rgb(0 0 0 / 40%),
        inset 0 0 0 1px rgb(255 255 255 / 15%);
}

.estante-lomo:active {
    transform: translateY(-6px);
}

.estante-lomo-icono {
    font-size: 1.4rem;
    filter: drop-shadow(0 1px 2px rgb(0 0 0 / 30%));
}

.estante-lomo-titulo {
    writing-mode: vertical-rl;
    text-orientation: mixed;
    font-size: 0.75rem;
    font-weight: 600;
    color: #fff;
    text-shadow: 0 1px 3px rgb(0 0 0 / 50%);
    letter-spacing: 0.05em;
    max-height: 90px;
    overflow: hidden;
}

.estante-sombra {
    width: 80%;
    height: 8px;
    background: radial-gradient(ellipse, rgb(0 0 0 / 15%) 0%, transparent 70%);
    margin-top: -8px;
}

/* --- Libro de Juegos (detalle de juego) --- */

.libro-juego-selector-label {
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--color-texto);
    margin: 4px 0 0;
}

/* --- Selector de héroe (fila de avatares) --- */

.selector-heroe {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    justify-content: center;
}

.selector-heroe-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 6px;
    border: 2px solid transparent;
    border-radius: 12px;
    background: rgb(0 0 0 / 5%);
    cursor: pointer;
    transition:
        border-color 0.2s ease,
        transform 0.15s ease,
        background 0.2s ease;
}

.selector-heroe-btn:hover {
    background: rgb(0 0 0 / 10%);
    transform: translateY(-2px);
}

.selector-heroe-btn.selector-heroe-activo {
    border-color: var(--color-dorado);
    background: rgb(200 160 80 / 15%);
    box-shadow: 0 0 12px rgb(200 160 80 / 30%);
}

.selector-heroe-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    box-shadow: 0 2px 6px rgb(0 0 0 / 20%);
}

.selector-heroe-nombre {
    font-size: 0.6rem;
    font-weight: 600;
    color: var(--color-texto-secundario);
    max-width: 52px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.selector-heroe-activo .selector-heroe-nombre {
    color: #5a3a1a;
}

/* --- Botón Jugar en Libro de Juegos --- */

.libro-juego-btn-jugar {
    padding: 10px 36px;
    border: none;
    border-radius: var(--radio-boton);
    background: linear-gradient(135deg, #4a7c59, #3a6a49);
    color: #fff;
    font-family: var(--font-body);
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition:
        transform 0.15s ease,
        box-shadow 0.15s ease,
        opacity 0.2s ease;
    box-shadow: 0 2px 8px rgb(74 124 89 / 40%);
    margin-top: 4px;
}

.libro-juego-btn-jugar:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 4px 16px rgb(74 124 89 / 50%);
}

.libro-juego-btn-jugar:disabled {
    opacity: 0.4;
    cursor: not-allowed;
}

/* ============================================================
   RESPONSIVE — Selección de personaje
   ============================================================ */

/* --- Tablet (481–768px) --- */
@media (width <= 768px) {
    #juego {
        padding: 30px 16px;
    }

    h1 {
        font-size: 2rem;
    }

    .modal-contenido {
        padding: 24px 28px;
    }

    .modal-derrota-caja {
        padding: 20px 24px;
    }

    .barra-superior {
        gap: 10px;
        padding: 6px 10px;
    }

    .barra-jugador img {
        width: 28px;
        height: 28px;
    }

    .barra-jugador span {
        font-size: 0.8rem;
    }

    .barra-vida-jugador {
        min-width: 80px;
    }

    .inventario-slot {
        width: 24px;
        height: 24px;
    }

    .toast-contenedor {
        right: 8px;
        width: 46px;
    }

    .toast {
        width: 40px;
        height: 40px;
        border-radius: 10px;
    }

    .toast-icono {
        font-size: 1.1rem;
    }

    .toast-mensaje {
        font-size: 0.7rem;
    }

    /* Libro tablet */
    .libro {
        max-width: 580px;
        height: 560px;
        max-height: calc(85vh - 40px);
    }

    .libro-pagina-izq {
        flex: 0 0 170px;
        padding: 16px;
    }

    .libro-pagina-der {
        padding: 16px;
    }

    .libro-titulo {
        font-size: 1rem;
    }

    .libro-detalle-contenido .avatar img {
        width: 90px;
        height: 90px;
    }

    .libro-esquina {
        width: 16px;
        height: 16px;
    }

    .libro-lomo {
        flex: 0 0 20px;
    }

    .libro-detalle-cabecera h3 {
        font-size: 1.1rem;
    }

    .libro-tab {
        font-size: 0.7rem;
        padding: 3px 10px;
    }

    .libro-nav-btn {
        width: 28px;
        height: 28px;
        font-size: 1rem;
    }

    .libro-nav-contador {
        font-size: 0.7rem;
    }

    .libro-modal-cuerpo {
        height: calc(100dvh - 50px);
    }
}

/* --- Mobile (≤480px) --- */
@media (width <= 480px) {
    #juego {
        padding: 8px;
    }

    .modal-contenido {
        padding: 20px;
    }

    .modal-contenido h2 {
        font-size: 1.1rem;
    }

    .modal-derrota-caja {
        padding: 18px 16px;
    }

    .modal-derrota-caja h2 {
        font-size: 1.05rem;
    }

    .barra-superior {
        gap: 6px;
        padding: 5px 8px;
    }

    .barra-jugador img {
        width: 24px;
        height: 24px;
    }

    .barra-jugador span {
        font-size: 0.75rem;
    }

    .barra-vida-texto {
        font-size: 0.6rem;
    }

    .barra-vida-jugador {
        min-width: 60px;
        gap: 4px;
    }

    .barra-vida-corazon {
        font-size: 0.75rem;
    }

    .inventario-slot {
        width: 22px;
        height: 22px;
    }

    .toast-contenedor {
        right: 6px;
        width: 42px;
    }

    .toast {
        width: 36px;
        height: 36px;
        border-radius: 8px;
    }

    .toast-icono {
        font-size: 1rem;
    }

    .toast-mensaje {
        font-size: 0.65rem;
        padding: 4px 10px;
    }

    /* Libro mobile */
    .libro {
        flex-direction: column;
        max-width: 100%;
        position: relative;
        flex: 1;
        min-height: 0;
    }

    .libro-pagina-izq {
        flex: none;
        padding: 10px 12px;
        overflow: hidden;
    }

    .libro-titulo {
        font-size: 0.95rem;
        margin-bottom: 4px;
    }

    .libro-ornamento {
        display: none;
    }

    /* Section tabs visibles en mobile */
    .libro-indice-secciones {
        display: flex;
        gap: 6px;
        justify-content: center;
        flex-wrap: wrap;
        margin: 6px 0 4px;
    }

    .libro-seccion-tab {
        background: rgb(255 215 0 / 8%);
        border: 1px solid rgb(255 215 0 / 15%);
        border-radius: 14px;
        color: rgb(180 165 140 / 60%);
        font-family: var(--font-display);
        font-size: 0.6rem;
        padding: 4px 10px;
        cursor: pointer;
        transition:
            color 0.2s,
            border-color 0.2s,
            background 0.2s;
        letter-spacing: 0.03em;
    }

    .libro-seccion-tab-activo {
        background: rgb(255 215 0 / 12%);
        border-color: var(--color-dorado);
        color: var(--color-dorado);
    }

    /* Wrapper del índice con hints de scroll */
    .libro-indice-wrap {
        position: relative;
        display: flex;
        align-items: center;
    }

    .libro-scroll-hint {
        display: block;
        flex-shrink: 0;
        color: var(--color-dorado);
        font-size: 0.85rem;
        line-height: 1;
        padding: 4px 0;
        border-bottom: 2px solid transparent;
        pointer-events: none;
        opacity: 0.6;
        text-shadow: 0 0 8px rgb(255 215 0 / 30%);
        animation: libro-hint-pulso 2s ease-in-out infinite;
        transition: opacity 0.3s;
    }

    .libro-scroll-hint-izq {
        animation-name: libro-hint-pulso-izq;
    }

    .libro-scroll-hint-der {
        animation-name: libro-hint-pulso-der;
    }

    .libro-scroll-hint-oculto {
        animation: none;
        opacity: 0;
    }

    @keyframes libro-hint-pulso-izq {
        0%,
        100% {
            opacity: 0.4;
            transform: translateX(0);
        }

        50% {
            opacity: 0.8;
            transform: translateX(-2px);
        }
    }

    @keyframes libro-hint-pulso-der {
        0%,
        100% {
            opacity: 0.4;
            transform: translateX(0);
        }

        50% {
            opacity: 0.8;
            transform: translateX(2px);
        }
    }

    /* Índice: scroll horizontal de una línea */
    .libro-indice {
        flex-flow: row nowrap;
        gap: 6px;
        margin: 4px 0;
        overflow-x: auto;
        scrollbar-width: none;
        -webkit-overflow-scrolling: touch;
        min-width: 0;
    }

    .libro-indice::-webkit-scrollbar {
        display: none;
    }

    .libro-indice-item {
        padding: 4px 6px;
        font-size: 0.65rem;
        text-align: center;
        border-left: none;
        border-bottom: 2px solid transparent;
        white-space: nowrap;
        flex-shrink: 0;
    }

    .libro-indice-activo {
        border-left-color: transparent;
        border-bottom-color: var(--color-dorado);
    }

    /* Ocultar separadores y labels de sección (reemplazados por section tabs) */
    .libro-indice-sep,
    .libro-indice-seccion {
        display: none;
    }

    .libro-lomo {
        display: none;
    }

    .libro-lomo-costura {
        display: none;
    }

    .libro-pagina-der {
        padding: 12px;
    }

    /* Fondo plano del personaje/villano cuando hay uno activo (no en Bienvenida ni habitaciones) */
    .libro:not(.libro-en-inicio, .libro-en-extra) > .libro-pagina-der {
        background: none;
        background-color: inherit;
    }

    .libro:not(.libro-en-inicio, .libro-en-extra) > .libro-pagina-der::before {
        display: none;
    }

    .libro-detalle-contenido {
        padding: 8px 12px;
    }

    .libro-detalle-contenido .avatar img {
        width: 80px;
        height: 80px;
    }

    .libro-esquina {
        width: 14px;
        height: 14px;
        opacity: 0.3;
    }

    .libro-detalle-cabecera h3 {
        font-size: 1rem;
    }

    .libro-tab {
        font-size: 0.65rem;
        padding: 3px 8px;
    }

    .libro-descripcion-grande {
        font-size: 0.8rem;
        line-height: 1.5;
    }

    .libro-nav-btn {
        width: 26px;
        height: 26px;
        font-size: 0.9rem;
    }

    .libro-nav-contador {
        font-size: 0.65rem;
    }

    .libro-boton {
        margin-top: 12px;
        padding: 4px;
    }

    .libro-boton img {
        width: 54px;
        height: 54px;
        border-radius: 10px;
    }

    .libro-boton-texto {
        font-size: 0.6rem;
    }

    .libro-modal-cuerpo {
        height: calc(100dvh - 36px);
    }

    .libro-modal-cerrar {
        width: 30px;
        height: 30px;
        font-size: 1.1rem;
        top: 6px;
        right: 6px;
    }

    .libro-habitacion {
        padding: 10px 14px;
    }

    .libro-habitacion-img {
        width: 80px;
        height: 80px;
    }

    .libro-habitacion-icono {
        width: 80px;
        height: 80px;
        font-size: 2rem;
    }

    .libro-habitacion-nombre {
        font-size: 1.05rem;
    }

    .libro-habitacion-desc p {
        font-size: 0.78rem;
    }

    .libro-habitacion-tip {
        font-size: 0.72rem;
        padding: 6px 10px;
    }
}

/* --- Pantallas muy pequeñas (≤360px) --- */
@media (width <= 360px) {
    .libro-detalle-contenido .avatar img {
        width: 64px;
        height: 64px;
    }

    .libro-esquina {
        display: none;
    }

    .libro-tab {
        font-size: 0.6rem;
        padding: 2px 6px;
    }

    .libro-detalle-cabecera h3 {
        font-size: 0.9rem;
    }

    .libro-descripcion-grande {
        font-size: 0.75rem;
    }

    .libro-indice-item {
        padding: 3px 5px;
        font-size: 0.6rem;
    }

    .libro-seccion-tab {
        font-size: 0.55rem;
        padding: 3px 8px;
    }
}

/* --- Pulido mobile --- */

/* Targets mínimos de 44x44px y posición de botones en touch */
@media (pointer: coarse) {
    .modal-derrota-btn,
    .btn-huir {
        min-height: 44px;
        min-width: 44px;
    }
}

/* Reducir animaciones pesadas si el usuario lo prefiere */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

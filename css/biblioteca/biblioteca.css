/* Biblioteca — escena inmersiva homepage */

/* --- Contenedor principal --- */

#biblioteca {
    width: 100%;
    height: 100dvh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #1a0e05 url('../../assets/img/biblioteca/sala-fondo.webp') center / cover no-repeat;
    overflow: hidden;
    position: relative;
}

/* Vignette sobre el fondo */
#biblioteca::after {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at center, transparent 30%, rgb(15 8 0 / 55%) 100%);
    pointer-events: none;
}

/* --- Escena contenedora --- */

.escena-biblioteca {
    position: relative;
    z-index: 2;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    max-width: 520px;
    padding: 0 20px;
}

/* --- Animación de entrada --- */

.escena-entrada .estante {
    animation: entrada-estante 0.8s ease-out both;
}

.escena-entrada .estante-sombra-piso {
    animation: entrada-sombra 0.8s ease-out 0.1s both;
}

@keyframes entrada-estante {
    from {
        opacity: 0;
        transform: scale(0.92) translateY(25px);
    }
}

@keyframes entrada-sombra {
    from {
        opacity: 0;
    }
}

/* --- Partículas flotantes (polvo dorado) --- */

.escena-particulas {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 3;
    overflow: hidden;
}

.particula {
    position: absolute;
    left: var(--x);
    bottom: -10px;
    width: var(--size);
    height: var(--size);
    border-radius: 50%;
    background: rgb(255 230 170);
    animation: flotar var(--dur) linear var(--delay) infinite;
}

@keyframes flotar {
    0% {
        transform: translateY(0) translateX(0);
        opacity: 0;
    }

    10% {
        opacity: var(--alpha);
    }

    90% {
        opacity: var(--alpha);
    }

    100% {
        transform: translateY(calc(-100vh - 20px)) translateX(var(--drift));
        opacity: 0;
    }
}

/* --- Overlay de luz de ventana --- */

.escena-luz {
    position: fixed;
    inset: 0;
    background: linear-gradient(
        115deg,
        rgb(255 215 130 / 10%) 0%,
        rgb(255 200 100 / 5%) 35%,
        transparent 60%
    );
    pointer-events: none;
    z-index: 3;
}

/* --- Mueble (vitrina semi-transparente) --- */

.estante {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    max-width: 460px;
    position: relative;
    background: rgb(40 25 12 / 22%);
    backdrop-filter: blur(6px);
    border: 1px solid rgb(180 140 80 / 20%);
    border-radius: 8px;
    overflow: hidden;
}

/* Corona — línea decorativa dorada */
.estante-corona {
    width: 100%;
    height: 3px;
    background: linear-gradient(
        90deg,
        transparent,
        rgb(200 160 80 / 50%) 20%,
        rgb(220 180 100 / 60%) 50%,
        rgb(200 160 80 / 50%) 80%,
        transparent
    );
}

/* Encabezado */
.estante-encabezado {
    width: 100%;
    padding: 16px 16px 12px;
    text-align: center;
    background: rgb(60 35 15 / 60%);
}

.estante-titulo {
    font-family: var(--font-display);
    font-size: 2rem;
    font-weight: 700;
    color: #f0d8a0;
    text-shadow:
        0 1px 0 rgb(0 0 0 / 40%),
        0 0 20px rgb(200 160 80 / 25%);
    margin: 0;
    letter-spacing: 0.04em;
    line-height: 1;
}

.estante-subtitulo {
    font-family: var(--font-display);
    font-size: 0.85rem;
    color: rgb(240 216 160 / 55%);
    margin: 4px 0 0;
    letter-spacing: 0.08em;
    font-style: italic;
}

/* --- Repisa con libros --- */

.estante-repisa {
    display: flex;
    justify-content: center;
    gap: 24px;
    padding: 28px 24px 20px;
    width: 100%;
    box-sizing: border-box;
    background: rgb(50 30 15 / 50%);
    perspective: 800px;
}

/* Contenedor de cada libro: lomo + etiqueta */
.estante-libro {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
}

/* Cada lomo de libro */
.estante-lomo {
    width: 105px;
    height: 190px;
    padding: 0;
    border: none;
    border-radius: 3px 6px 6px 3px;
    cursor: pointer;
    position: relative;
    transform-style: preserve-3d;
    overflow: hidden;
    transition:
        transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94),
        box-shadow 0.35s ease;
    box-shadow:
        2px 3px 10px rgb(0 0 0 / 40%),
        inset 0 0 0 1px rgb(255 255 255 / 8%);
    background: var(--lomo-color);
}

/* Páginas visibles en el canto derecho */
.estante-lomo::after {
    content: '';
    position: absolute;
    top: 4px;
    right: -3px;
    bottom: 4px;
    width: 3px;
    background: linear-gradient(180deg, #f0e4d0, #e0d4c0 50%, #d0c4b0);
    border-radius: 0 2px 2px 0;
    box-shadow: 1px 0 3px rgb(0 0 0 / 20%);
}

/* Hover y focus: extracción 3D con glow */
.estante-lomo:hover,
.estante-lomo:focus-visible {
    transform: rotateY(-8deg) translateY(-12px) translateZ(10px);
    box-shadow:
        4px 10px 25px rgb(0 0 0 / 50%),
        0 0 30px color-mix(in srgb, var(--lomo-color) 35%, transparent),
        inset 0 0 0 1px rgb(255 255 255 / 15%);
}

.estante-lomo:active {
    transform: rotateY(-4deg) translateY(-6px) translateZ(5px);
    transition-duration: 0.1s;
}

/* Imagen completa del lomo (cubre todo el botón, ligeramente ampliada para recortar bordes claros) */
.estante-lomo-img {
    position: absolute;
    inset: -4px;
    width: calc(100% + 8px);
    height: calc(100% + 8px);
    object-fit: cover;
    border-radius: inherit;
    transition: filter 0.3s ease;
}

.estante-lomo:hover .estante-lomo-img,
.estante-lomo:focus-visible .estante-lomo-img {
    filter: brightness(1.15);
}

/* Etiqueta del libro — debajo del lomo */
.estante-lomo-titulo {
    font-family: var(--font-display);
    font-size: 0.72rem;
    font-weight: 600;
    font-variant: small-caps;
    letter-spacing: 0.1em;
    line-height: 1.3;
    text-align: center;
    max-width: 110px;
    color: rgb(220 190 130 / 90%);
    text-shadow: 0 0 12px rgb(200 160 80 / 30%);
    transition: color 0.3s ease;
}

/* Brillo del título al hacer hover en el libro */
.estante-libro:hover .estante-lomo-titulo {
    color: rgb(240 216 160);
    text-shadow:
        0 0 8px rgb(200 160 80 / 40%),
        0 0 20px rgb(200 160 80 / 15%);
}

/* --- Tabla de la repisa (canto frontal) --- */

.estante-tabla {
    width: 100%;
    height: 8px;
    background: linear-gradient(180deg, rgb(140 110 75 / 60%), rgb(100 75 50 / 40%));
    box-shadow: 0 3px 8px rgb(0 0 0 / 20%);
}

/* --- Base del mueble --- */

.estante-base {
    width: 100%;
    height: 4px;
    background: linear-gradient(180deg, rgb(0 0 0 / 15%), rgb(0 0 0 / 30%));
}

/* --- Sombra en el piso --- */

.estante-sombra-piso {
    width: 70%;
    max-width: 360px;
    height: 12px;
    background: radial-gradient(
        ellipse at 50% 0%,
        rgb(0 0 0 / 25%) 0%,
        rgb(0 0 0 / 8%) 50%,
        transparent 80%
    );
    margin-top: -1px;
}

/* --- Responsive --- */

@media (width <= 768px) {
    .estante-titulo {
        font-size: 1.7rem;
    }

    .estante-subtitulo {
        font-size: 0.78rem;
    }

    .estante-repisa {
        gap: 18px;
        padding: 22px 20px 16px;
    }

    .estante-lomo {
        width: 90px;
        height: 165px;
    }

    .estante-libro {
        gap: 8px;
    }

    .estante-lomo-titulo {
        font-size: 0.68rem;
        max-width: 95px;
    }
}

@media (width <= 480px) {
    .escena-biblioteca {
        padding: 0 12px;
    }

    .estante-titulo {
        font-size: 1.4rem;
    }

    .estante-encabezado {
        padding: 12px 12px 8px;
    }

    .estante-repisa {
        gap: 12px;
        padding: 18px 14px 12px;
    }

    .estante-lomo {
        width: 74px;
        height: 140px;
    }

    .estante-libro {
        gap: 6px;
    }

    .estante-lomo-titulo {
        font-size: 0.62rem;
        max-width: 80px;
        letter-spacing: 0.06em;
    }
}
